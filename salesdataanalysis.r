# relevant source files to do the analysis
library(car)

# building of data frame from 229 observations comprising of day, promotional sales (in millions) and non-promotional sales (in millions)
day <- c(1:229)
promosales <- c(0.31,23.62,21.87,18.6,10.14,9.26,9.82,8.95,14.9,15.92,13.43,10.33,8.11,8.68,6.83,12.52,14.14,11.1,10.43,10.39,26.65,19.58,33.14,30.73,24.2,7.6,6.35,6.51,5.97,11.54,10.7,7.85,6.81,7.05,6.69,5.48,11.34,10.13,6.85,5.83,5.33,5.19,4.3,8.98,8.19,6.37,6.48,5.58,5.77,4.38,12.86,12.82,10.07,9.49,9.03,19.04,13.67,22.95,21.96,17.4,5.98,6.21,7.71,8.15,15.85,17.51,13.35,7.46,6.24,7.2,5.16,11.16,11.96,11.1,10.07,8.36,10.59,8.73,17.29,17.37,10.61,9.07,7.08,6.35,4.77,8.67,9.35,6.81,5.86,5.57,5.82,4.49,9.89,11.62,8.85,6.88,6.28,6.2,4.77,10.34,9.56,7.42,7.08,7.03,15.29,10.9,19.49,20.09,15.92,7.74,6.32,6.01,4.71,9.43,10.8,9.45,9.57,9.17,6.78,4.79,9.84,11.59,9.47,7.61,6.79,6.22,4.96,9.81,10.15,7.44,6.58,6.28,6.1,4.95,9.14,10.76,8.12,6.8,7.3,8.12,6.87,29.01,26.39,11.16,10.73,10.29,9.29,6.22,15.06,13.79,10.95,9.66,9.36,8.62,9.21,21.79,18.26,13.89,12.19,6.93,6.47,7.6,14.04,13.96,10.41,6.63,6.19,6.06,7.97,18.49,21.01,19.2,17.31,7.19,18.51,14.18,25.33,24.67,20.27,6.66,5.44,5.56,5.25,11.84,11.92,9.46,7.78,7.18,5.38,4.09,8.2,8,6.26,6.11,5.91,5.75,5.09,12.59,11.85,9.17,6.97,5.45,5.35,5.25,9.48,11.69,9.26,10.2,6,5.36,4.5,9.67,10.4,8.09,6.71,5.96,4.92,3.6,7.36,8.27,6.2,6.34,6.32,5.4,1.07,9.82,9.77,10.64,6.65)
nonpromosales <- c(0.9,31.56,32.53,30.03,33.29,32.54,28.59,21.93,36.82,34.06,29.97,29.31,28.58,27.8,20.75,34.61,35.33,32.71,29.4,28.49,25.17,18.27,30.42,31.26,27.93,28.84,28.55,29.12,21.24,38.15,36.16,32.78,30,29.48,28.28,21.64,37.58,35.72,32.78,31.1,29.62,29.09,22.28,40.22,38.04,33.27,32.84,31.29,30.58,21.23,41.06,40.34,36.32,29.82,28.39,25.67,18.04,31.47,32.49,29.16,28.6,29.04,27.02,20.71,34.74,33.35,31.03,29.67,28.44,29.13,20.56,38.57,36.18,33.15,33.03,32.5,26.69,19.93,34.36,36.85,34.71,31.96,31.25,29.7,20.51,35.27,36.66,33.92,31.94,29.99,30.31,20.86,38.29,37.65,34.08,34.94,36.88,26.89,19.15,34.43,31.52,30.54,29,29.02,26.88,19.08,32.63,33.88,29.27,28.09,28.18,27.97,20.36,34.26,34.33,31.81,29.06,29.38,28.08,20.86,36.26,35.63,32.61,30.29,29.78,28.6,21.54,38.32,33.99,32.8,30.26,30.55,30.3,22.54,38.49,37.61,34.9,31.92,32.19,31.25,23.14,31.08,30.68,33.04,31.05,30.69,29.74,20.25,41.08,39.18,35.64,33.08,32.73,27.76,20.65,36.35,34.78,31.17,29.41,28.59,27.93,20.01,36.28,33.68,30.69,31.03,29.5,28.26,22.65,35.18,32.94,28.38,25.96,30.32,22.5,18.63,34.17,33.64,30.78,30.23,29.15,28.55,21.8,39.89,36.86,31.24,30.39,29.7,29.57,22.12,47.96,37.69,34.65,31.68,28.57,25.45,18.27,48.54,36.06,33.5,29.23,28.15,27.94,21.5,48.74,35.85,30.92,27.9,26.14,26.88,19.92,46.78,35.03,31.13,28.76,28.07,27.91,19.97,44.67,34.92,31.17,29.13,29.41,21.96,4.94,46.8,33.3,38.94,33.47)
df <- data.frame(day,promosales,nonpromosales)
summary(df)

# curve fitting based on sales recorded on each day to graphically represent the two types of sales 
plot(c(1,229),c(0.300000,50),type="n",xlab="Day",ylab="Sales Amt in Millions")
lines(day,df$promosales,col="red",lwd=2.5)
lines(day,df$nonpromosales,col="blue",lwd=2.5)
legend(0,50,c("Promotional Sales","Non Promotional Sales"),lty=c(1,1),lwd=c(2.5,2.5),col=c("red","blue"))

# establish pre-requisites are met to apply t-test i.e. both follows normal distribution
par(mfrow=c(1,2))
hist(df$promosales,main="",xlab="promotional sales",prob=T)
lines(density(df$promosales),lty="dashed",lwd=2.5,col="red")
hist(df$nonpromosales,main="",xlab="non-promotional sales",prob=T)
lines(density(df$nonpromosales),lty="dashed",lwd=2.5,col="red")

# perform t-test to identify the winner
t.test(df$promosales,df$nonpromosales)
